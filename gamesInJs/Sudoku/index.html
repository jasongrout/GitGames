<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Sudoku</title>
  <style>
    * { padding: 0%; margin: 0; }
    canvas { background: #eee; display: block; margin: 0 auto; }
  </style>
</head>
<body>

  <canvas id="myCanvas" width="480" height="480"></canvas>

  <script>
    var canvas = document.getElementById("myCanvas");
    var ctx = canvas.getContext("2d");
    ctx.font = "30px Arial";
    //ctx.fillText("Hello World", 10, 50); example font
    var cellSize = 50;
    var lineWidth = 1;
    var gridColor = 'blue';
    var textColor = 'orange';
    //    var output = 0;
    var xPos = -1;
    var yPos = -1;
    var output = 0;

    var numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9]

    puzzle = []
    for (x = 0; x<9; x++){
	puzzle[x] = []
	for (y = 0; y<9; y++){
	    puzzle[x][y] = 0;
	}
    }
    
    function choice(array) {
	return Math.floor(Math.random() * array.length);
    }
    
    function generatePuzzle(){
	for (index = 0; index < 81; index++){
	    x = index % 9;
	    y = Math.floor(index/9);
	    console.log(x, y);
	    numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
	    row = [];//get the items in the same row
	    for (i = 0; i > 9; i ++) {
		row.push(puzzle[i][y])
	    }
	    box = [];
	    numbersToUse = []
	    for (num in numbers) {
		if (puzzle[x].includes(parseInt(num))) {//vertical check
		    console.log(num);
		} else if (row.includes(parseInt(num))) {
		    console.log(num);
		} else {
		    numbersToUse.push(parseInt(num));
		}
	    }
	    console.log(numbersToUse)
	    c = choice(numbersToUse)
	    puzzle[x][y] = numbersToUse[c]
	}
    }
    
    function gatherInput(){
	if (xPos < 0 || xPos > 9 || yPos < 0 || yPos > 9) {
	    console.log("Click out of range");
	} else if (output == 0) {
	    //pass
	} else {
	    console.log(xPos, yPos, output)
	    puzzle[xPos][yPos] = output;
	    xPos = -1;
	    yPos = -1;
	    output = 0;
	    console.log("!!! PUZZLE CHANGED !!!");
	}
    }
    
    function keyPressed(event){
	console.log("Pressed...")
	output = 0;
	if (event.key == '1'){
	    output = 1;
	}else if (event.key == '2') {
	    output = 2;
	}else if (event.key == '3') {
	    output = 3;
	}else if (event.key == '4') {
	    output = 4;
	}else if (event.key == '5') {
	    output = 5;
	}else if (event.key == '6') {
	    output = 6;
	}else if (event.key == '7') {
	    output = 7;
	}else if (event.key == '8') {
	    output = 8;
	}else if (event.key == '9') {
	    output = 9;
	}
    }
    
    function mouseClicked(event){
	x = event.clientX - canvas.offsetLeft;
	y = event.clientY - canvas.offsetTop;
	// I am cleaning up the x and y so that they start on the squares
	x = x - ((canvas.width/2) - 4.5 * cellSize)
	y = y - ((canvas.height/2) - 4.5 * cellSize)
	//Here is where I condense the cords to a x, y cord on the puzzle
	xPos = Math.floor((x / cellSize))
	yPos = Math.floor((y / cellSize))
	console.log(xPos, yPos);
    }


    
    function drawGrid(){
	for (x = 0; x<10; x++){//make a set of 10 vertical lines in the center of the screen
	    //console.log(x);
	    if (x%3 == 0){
		lineWidth = 3;
		//console.log("Thick")
	    }else{
		lineWidth = 1;
	    }
	    ctx.beginPath();
//	    console.log(((canvas.width/2) - 4.5*cellSize) + x*cellSize)
	    ctx.rect(((canvas.width/2) - 4.5*cellSize) + x*cellSize, ((canvas.height/2) - 4.5*cellSize), lineWidth, cellSize*9);
	    ctx.fillStyle = gridColor;
	    ctx.fill();
	    ctx.closePath();
	    //draw the horz lines
	    ctx.beginPath();
	    ctx.rect(((canvas.width/2) - 4.5*cellSize), ((canvas.height/2) - 4.5*cellSize) + x*cellSize, cellSize*9+3, lineWidth);
	    ctx.fillStyle = gridColor;
	    ctx.fill();
	    ctx.closePath();
	}
    }

    function drawPuzzle() {
	for (rowIndex = 0; rowIndex < puzzle.length; rowIndex++){
	    for (colIndex = 0; colIndex < puzzle[rowIndex].length; colIndex++){
		if (puzzle[rowIndex][colIndex] != 0) {
		    ctx.fillColor = textColor
		    ctx.fillText(puzzle[rowIndex][colIndex], ((canvas.width/2) - 4.5*cellSize)+cellSize*rowIndex+(cellSize/3), ((canvas.height/2) - 4.5*cellSize)+colIndex*cellSize+(cellSize/1.25));
		}
	    }
	}
    }
    function draw() {
	ctx.clearRect(0, 0, canvas.width, canvas.height);
	drawGrid();
	gatherInput();
	drawPuzzle();
    }
    canvas.addEventListener("click", mouseClicked, false);
    document.addEventListener('keydown', keyPressed, false);

    generatePuzzle();
    interval = setInterval(draw, 100)
  </script>

</body>
</html>
